# Production Environment Configuration for Vercel Deployment
# Copy relevant values to Vercel Environment Variables dashboard

# ============================================================================
# REQUIRED: Database Configuration
# ============================================================================
# Use Vercel Postgres, Neon, or other serverless PostgreSQL
DATABASE_URL=postgresql://user:password@host:5432/database
# Alternative names that work on Vercel:
# POSTGRES_URL=
# POSTGRES_PRISMA_URL=
# POSTGRES_URL_NON_POOLING=

# ============================================================================
# Environment
# ============================================================================
NODE_ENV=production

# ============================================================================
# HAPI Validator Configuration (Disabled for Vercel)
# ============================================================================
# HAPI requires Java and 170MB JAR file - not available in Vercel serverless
# The app will gracefully fall back to schema-based validation
HAPI_ENABLED=false

# ============================================================================
# Validation Configuration
# ============================================================================
# Enable schema-based structural validation (JavaScript-based, works on Vercel)
ENABLE_SCHEMA_VALIDATION=true

# Enable other validation aspects (all work on Vercel)
ENABLE_REFERENCE_VALIDATION=true
ENABLE_BUSINESS_RULE_VALIDATION=true
ENABLE_METADATA_VALIDATION=true
ENABLE_TERMINOLOGY_VALIDATION=true

# ============================================================================
# Terminology Servers (External APIs - work on Vercel)
# ============================================================================
HAPI_TX_ONLINE_R4=https://tx.fhir.org/r4
HAPI_TX_ONLINE_R5=https://tx.fhir.org/r5
HAPI_TX_ONLINE_R6=https://tx.fhir.org/r6

# ============================================================================
# Feature Flags
# ============================================================================
ENABLE_EXPERIMENTAL_FEATURES=false
ENABLE_PERFORMANCE_TRACKING=true
ENABLE_AUDIT_TRAIL=true
STRICT_VALIDATION_MODE=false

# ============================================================================
# FHIR Configuration
# ============================================================================
HAPI_DEFAULT_VERSION=R4
HAPI_SUPPORT_R5=true
HAPI_SUPPORT_R6=true

# ============================================================================
# Performance Settings (Adjusted for Serverless)
# ============================================================================
# Process pools don't work in serverless - these will be ignored
HAPI_USE_PROCESS_POOL=false
HAPI_POOL_SIZE=1

# Timeout for serverless function (max 60s on Vercel Pro, 10s on Hobby)
HAPI_TIMEOUT=30000

# ============================================================================
# Vercel-Specific Notes
# ============================================================================
# 
# What Works on Vercel:
# ✅ Schema-based FHIR structure validation
# ✅ Reference validation (checks FHIR references)
# ✅ Business rule validation (FHIRPath expressions)
# ✅ Metadata validation (completeness checks)
# ✅ Terminology validation (via external APIs)
# ✅ Database operations (with Neon/Vercel Postgres)
# 
# What Doesn't Work:
# ❌ HAPI Java validator (requires 170MB JAR + Java runtime)
# ❌ Process pools (serverless doesn't support long-running processes)
# ❌ Deep profile validation (HAPI-dependent)
# 
# The application will automatically detect serverless environment and:
# - Skip HAPI validator initialization
# - Fall back to schema-based validation
# - Disable features that require persistent processes
# - Use graceful degradation for unsupported operations

